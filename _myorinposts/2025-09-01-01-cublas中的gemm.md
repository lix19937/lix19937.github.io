---
title: 'cublas中的gemm'
date: 2025-09-01
layout: single
author_profile: true
read_time: true
comments: true
share: true
related: true

permalink: /myorinposts/2025/09/gemm/
tags:
  - sdk

---


本文回顾cublas 中gemm 相关使用。   


<img width="250" height="333" alt="Row_and_column_major_order svg" src="https://github.com/user-attachments/assets/f802bf51-7aa1-4a7e-83ff-8b848ceb40b2" />


<img width="1039" height="827" alt="gemm" src="https://github.com/user-attachments/assets/6b948cbf-f84d-45d8-9068-f668706fa4db" />



https://stackoverflow.com/questions/74884755/using-cublasgemmbatchedex
https://salykova.github.io/sgemm-gpu

https://docs.nvidia.com/datacenter/dcgm/2.0/dcgm-user-guide/feature-overview.html#profiling-metrics

行主序中，在同一行的元素在内存中是相邻的；列主序中，同一列的元素在内存中是相邻的。


为什么 cublas 不做一个offline/init 函数，用来找到最佳策略，然后搭配一个run 函数  

sudo nvidia-smi --lock-gpu-clocks=1695,1695


cublasSgemm(handle, CUBLAS_OP_N, CUBLAS_OP_N, 2 ,4, 3, &alpha, *A, 2, *B, 3, &beta, *C, 2);
